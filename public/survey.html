<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
   
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <title>Friend Finder Survey</title>
</head>

<body>
    <div class="container" id="bg">
        <div class="container">
            <div class="jumbotron">
                <h1 class="text-center">Find Your New Best Friend!</h1>
            </div>
        </div>
        <div class="container">
            <div class="text-center">
                <a href="/"><button type="button" class="btn btn-lg btn-success"> Home</button></a>
            </div>
        </div>
        <br><br>
        <div class="container">
            <div class="row">
                <div class="card">
                    <div class="card-header">
                        <h2>Enter your name, a picture , and how well the statements below describe you.</h2>
                    </div>
                    <div class="card-body">
                        <form id="submitForm" role="form">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" class="form-control" id="name">
                            </div>
                            <div class="form-group">
                                <label for="picture">Picture</label>
                                <input type="text" class="form-control" id="picture"
                                    placeholder="Please include a picture of yourself, or a picture you connect with.">
                            </div>
                            <!-- Question 1 -->
                            <div class="form-group">
                                <label for="question-one">1. You tend to spend your free time alone.</label>
                                <select data-placeholder="" class="chosen-select" id="question-one">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 2 -->
                            <div class="form-group">
                                <label for="question-two">2. You like playing Outdoors.</label>
                                <select data-placeholder="" class="chosen-select" id="question-two">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 3 -->
                            <div class="form-group">
                                <label for="question-three">3. You see your Family often.</label>
                                <select data-placeholder="" class="chosen-select" id="question-three">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 4 -->
                            <div class="form-group">
                                <label for="question-four">4. You tend to be the "Advice-Giver" in a group.</label>
                                <select data-placeholder="" class="chosen-select" id="question-four">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 5 -->
                            <div class="form-group">
                                <label for="question-five">5. You have at least one pet.</label>
                                <select data-placeholder="" class="chosen-select" id="question-five">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 6 -->
                            <div class="form-group">
                                <label for="question-six">6. You're curious.</label>
                                <select data-placeholder="" class="chosen-select" id="question-six">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 7 -->
                            <div class="form-group">
                                <label for="question-seven">7. You are fond of Classical Music.</label>
                                <select data-placeholder="" class="chosen-select" id="question-seven">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 8 -->
                            <div class="form-group">
                                <label for="question-eight">8. You have lost track of how many books you
                                    own.</label>
                                <select data-placeholder="" class="chosen-select" id="question-eight">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>
                            <!-- Question 9 -->
                            <div class="form-group">
                                <label for="question-nine">9. You enjoy learning about science and
                                    space.</label>
                                <select data-placeholder="" class="chosen-select" id="question-nine">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>

                            </div>
                            <!-- Question 10 -->
                            <div class="form-group">
                                <label for="question-ten">10. You enjoy watching the sun set.</label>
                                <select data-placeholder="" class="chosen-select" id="question-ten">
                                    <option value=""></option>
                                    <option value="1">1 (Sounds like me)</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5 (Not like me)</option>
                                </select>
                            </div>

                            <button type="submit" class="btn btn-info submit">Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p> copywrite 2019 </p>
        </div>
    </footer>
</body>
<br>
<div id="resultsModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"></button>
                <h1 class="modal-title">Your friend/ neighbor match is:</h1>
            </div>
            <div class="modal-body">
                <h2 id="matchName"></h2>
                <br>
                <img id="matchPic" alt="" height=300px width=300px overflow=hidden>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>

    // The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
    $.ajax({
        url: "/api/friends",
        method: "GET"
        
    })
        .then(function (friends) {
            // Here we then log the tableData to console, where it will show up as an object.
            console.log(friends);
            console.log("------------------------------------");

            $('#submitForm').on('submit', function (event) {
                event.preventDefault();
                console.log("made it to on click");

                //now validate to ensure all needed questions are answered
                function validate() {
                    var trueValid = true;
                    $('.form-control').each(function () {
                        if ($(this).val() === '') {
                            trueValid = false;
                        }
                    });
                    return trueValid;
                }
                if (validate() === true) {
                    var newFriend = {
                        userName: $('#name').val().trim(),
                        userPhoto: $('#picture').val().trim(),
                        userScores: [
                            Number($('#question-one').val().trim()),
                            Number($('#question-two').val().trim()),
                            Number($('#question-three').val().trim()),
                            Number($('#question-four').val().trim()),
                            Number($('#question-five').val().trim()),
                            Number($('#question-six').val().trim()),
                            Number($('#question-seven').val().trim()),
                            Number($('#question-eight').val().trim()),
                            Number($('#question-nine').val().trim()),
                            Number($('#question-ten').val().trim())
                        ]
                    };
                    console.log("new friend" + newFriend);

                    //now create a post call to add in the new friend to the friendsArr 
                    var URL = window.location.origin;
                    $.post(URL + '/api/friends', newFriend,
                        //this displays the match data to the modal
                        function (data) {
                            $('#matchName').text(data.userName);
                            $('#matchPic').attr('src', data.userPhoto);
                            $('#resultsModal').modal('toggle')
                            console.log(data.userName);
                            $('#userName').val('');
                            $('#userPhoto').val('');
                            $('.chosen-select').val('');
                        }).then;
                } else alert('Missing Entry Please Review your Answers, and Complete all Fields.');
            });
        });

</script>

</html>